# 쿠키, 세션, 캐시

- 웹 개발을 한다면 정말 자주 듣는 용어입니다.
- 정의와 사용 이유에대해 알아보도록 하겠습니다.

---

## HTTP 특징

앞선 내용을 설명하기 전에 HTTP 프로토콜의 특성을 이해해야합니다.
HTTP는 'Connetionless, Stateless'한 특성을 가지고 있는데 이러한 특성을 보완하기 위해 쿠키와 세션을 사용합니다.

HTTP 특성

- Connectionless
  - 클라이언트가 서버에 요청을 한 후 서버에게로부터 응답을 받으면 그 후 바로 연결을 끊어 버리는 특징
- Stateless
  - 클라이언트와 서버의 통신이 끝나면 해당 상태를 유지하지 않는 특징

이러한 특성때문에 클라이언트와 서버가 서로 정보를 주고 받았던 상태를 전혀 기억하지 못합니다.

---

## 쿠키(Cookie)

웹 브라우저가 별도의 쿠기 저장소에 보관하며, 키와 값으로 구분된 문자열의 작은 데이터 파일입니다.

웹 서버에서 웹 브라우저에게 데이터를 전송하며, 데이터의 유효기간을 지정할 수 있습니다.

- 유효기간동안 웹 브라우저의 쿠키 저장소에 쿠키가 저장되고, 유효기간을 지정하지 않으면 웹 브라우저를 종료할 때 삭제됩니다.
  > 유효기간 미지정 시 **메모리에 기록**되기 때문에 웹 브라우저 종료시 날아갑니다.
  > 유효기간 이내에는 클라이언트의 **하드디스크에 저장**됩니다.

### 쿠키의 동작방식

먼저, 웹 브라우저가 웹 서버에 웹 페이지를 요청하면, 서버에서는 웹 페이지를 보내주면서 쿠키도 끼워보내줍니다.

그럼, 웹 브라우저는 별도의 쿠키 저장소에 쿠키를 저장해둡니다.

- 이때, 유효기간 여부에 따라 저장 위치가 달라집니다.

쿠키는 기본적으로 쿠키를 생성한 웹 서버에만 전송합니다.

### 쿠키의 단점

- 보안성이 낮습니다.
  - 제 3자가 컴퓨터를 사용하거나 해킹하여 접속한다면 충분히 쿠키를 열어볼 수 있습니다.
- 클라이언트는 총 300개의 쿠키를 저장할 수 있고, 하나의 도메인당 20개의 쿠키만 가질수 있습니다.
  - 20개가 초과되면 가장 오래된 쿠키부터 자동 삭제됩니다.
- 하나의 쿠키는 4KB(4069 byte)까지 저장할 수 있습니다.

### 쿠키의 장점

- 속도가 빠릅니다.
  - 서버에 요청하지 않고 바로 꺼내올 수 있기 때문입니다.
- 서버 부하가 낮습니다.
  - 서버에 요청하는 빈도 수가 줄어들기 때문입니다.

쿠키는 주로 **아이디 자동저장**, **팝업 보지 않기**, **쇼핑몰의 장바구니**에 주로 사용됩니다.

---

## 세션(Session)

세션은 쿠키를 기반으로 하며 정보 파일을 서버측에서 관리합니다. 웹 서버 내 웹 컨테이너에 클라이언트의 상태 또는 값을 저장합니다.

웹 컨테이너는 하나의 클라이언트마다 한 세션을 생성합니다. 즉, 하나의 클라이언트가 여러 요청을해도 웹 컨테이너는 하나의 세션만 생성해 사용합니다.

> 브라우저가 닫히거나 서버 내에서 세션 삭제 시 사라집니다.
> 세션이 유효시간을 갖지 않으면, 나중에 세션 객체가 웹 컨테이너에 쌓이게 되서 메모리가 부족해질 수 있습니다.

- 세션의 구성 요소: 세션 ID, 세션 생성 시간, 세션의 최근 접근 시간

클라이언트가 웹 서버에 요청할 때 세션이 만들어지는데, 웹 서버에서 클라이언트를 구분하기 위해 세션 ID를 만듭니다.

하지만 같은 클라이언트가 요청했는지, 다른 클라이언트가 요쳥했는지 스스로 구분할 수 없기 때문에 세션을 만들면서 별로도 클라이언트에 세션 ID값이 담긴 쿠키를 만들어 저장합니다.

따라서 웹 서버에 요청할 때 쿠키도 같이 보내서 웹 서버가 세션 ID를 비교하여 세션 값을 꺼내 읽어올 수 있게 됩니다.

세션은 주로 로그인 정보 유지에 사용됩니다.

---

따라서 내가 저장하고자 하는 정보 파일이 보안이 좀 더 중요한지 아니면 전반적인 서비스 서버의 성능 속도가 중요한지 등을 고려해 쿠키나 세션을 사용하면 됩니다.

---

## 캐시(Cache)

리소스 파일들의 임시 저장소입니다.
클라이언트(웹 브라우저)가 동일한 주소로 연속으로 요청할 경우 첫 번째 요청 결과를 로컬 PC의 캐시에 저장해둔 다음, 두 번째 요청 시 서버에 접근하는 것 대신 로컬 PC의 캐시를 가져오는 방식입니다.

요청의 결과 값은 보통 이미지 또는 사진 파일, css, js, 배너 등 변경 사항이 크지 않고, 용량이 큰 파일들입니다. 이런 데이터는 다시 사용될 가능성이 높고 매번 다시 다운받으려면 시간이 오래 걸리기 때문에 캐시에 저장하고 다시 재사용하는 것입니다.

하지만 이것 또한 자주 변경되는 데이터를 캐시 방식으로 개발한다면 클라이언트가 이전 캐시를 삭제하지 않는 한 변경된 데이터를 출력하는 것이 아니라 이전 데이터만 출력되기 때문에 목적에 맞는 저장 방식을 사용하는 것이 중요합니다.

참고

- [https://velog.io/@gwanuuoo/쿠키,세션,캐시란?](https://velog.io/@gwanuuoo/%EC%BF%A0%ED%82%A4-%EC%84%B8%EC%85%98-%EC%BA%90%EC%8B%9C%EB%9E%80)
- [https://www.startupcode.kr/company/blog/archives/13](https://www.startupcode.kr/company/blog/archives/13)
